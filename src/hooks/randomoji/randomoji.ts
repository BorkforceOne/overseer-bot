import { Client, Message, Emoji, GuildEmoji } from 'discord.js';
import { Hook } from '../../utils/hook';
import { DiscordService } from '../../services/app/discord_service';
import { RandomThrottleStrategyService } from '../../services/throttle/randomThrottleStrategy.service';
import { throttle } from '../../services/throttle/throttle';

const list = [
  'âŒš',
  'â˜',
  'âšª',
  'âš½',
  'â›„',
  'âœŠ',
  'âœŒ',
  'ğŸŒ€',
  'ğŸŒ¡',
  'ğŸŒ¤',
  'ğŸŒ­',
  'ğŸŒ°',
  'ğŸŒ¶',
  'ğŸŒ·',
  'ğŸ½',
  'ğŸ¾',
  'ğŸ€',
  'ğŸ ',
  'ğŸ…',
  'ğŸ†',
  'ğŸ‹',
  'ğŸ ',
  'ğŸ¸',
  'ğŸ€',
  'ğŸ‘€',
  'ğŸ‘',
  'ğŸ‘‚',
  'ğŸ•',
  'ğŸ•¯',
  'ğŸ•³',
  'ğŸ•º',
  'ğŸ–',
  'ğŸ–•',
  'ğŸ—»',
  'ğŸ˜€',
  'ğŸ˜',
  'ğŸ˜‘',
  'ğŸ˜’',
  'ğŸ˜•',
  'ğŸ˜–',
  'ğŸ˜—',
  'ğŸ˜˜',
  'ğŸ˜™',
  'ğŸ˜š',
  'ğŸ˜›',
  'ğŸ˜œ',
  'ğŸ˜Ÿ',
  'ğŸ˜ ',
  'ğŸ˜¦',
  'ğŸ˜¨',
  'ğŸ˜¬',
  'ğŸ˜­',
  'ğŸ˜®',
  'ğŸ˜°',
  'ğŸ˜´',
  'ğŸ˜µ',
  'ğŸ™',
  'ğŸ™ƒ',
  'ğŸ™…',
  'ğŸš€',
  'ğŸ›‹',
  'ğŸ›',
  'ğŸ›‘',
  'ğŸ› ',
  'ğŸ›©',
  'ğŸ›«',
  'ğŸ›°',
  'ğŸ›³',
  'ğŸ›´',
  'ğŸ¤',
  'ğŸ¤™',
  'ğŸ¤ ',
  'ğŸ¤°',
  'ğŸ¤³',
  'ğŸ¤¼',
  'ğŸ¥€',
  'ğŸ¥‡',
  'ğŸ¥',
  'ğŸ¦€',
  'ğŸ¦…',
  'ğŸ§€',
  'âŒš',
  'â°',
  'â³',
  'â—½',
  'â˜”',
  'âš“',
  'âš¡',
  'âšª',
  'âš½',
  'â›„',
  'â›”',
  'â›ª',
  'â›²',
  'â›µ',
  'âœŠ',
  'ğŸŒ€',
  'ğŸŒ­',
  'ğŸŒ°',
  'ğŸŒ·',
  'ğŸ¾',
  'ğŸ€',
  'ğŸ ',
  'ğŸ…',
  'ğŸ†',
  'ğŸ',
  'ğŸ ',
  'ğŸ´',
  'ğŸ¸',
  'ğŸ€',
  'ğŸ‘€',
  'ğŸ‘‚',
  'ğŸ“¸',
  'ğŸ“¹',
  'ğŸ”€',
  'ğŸ•',
  'ğŸ•º',
  'ğŸ–•',
  'ğŸ–¤',
  'ğŸ—»',
  'ğŸ˜€',
  'ğŸ˜',
  'ğŸ˜‘',
  'ğŸ˜’',
  'ğŸ˜•',
  'ğŸ˜–',
  'ğŸ˜—',
  'ğŸ˜˜',
  'ğŸ˜™',
  'ğŸ˜š',
  'ğŸ˜›',
  'ğŸ˜œ',
  'ğŸ˜Ÿ',
  'ğŸ˜ ',
  'ğŸ˜¦',
  'ğŸ˜¨',
  'ğŸ˜¬',
  'ğŸ˜­',
  'ğŸ˜®',
  'ğŸ˜°',
  'ğŸ˜´',
  'ğŸ˜µ',
  'ğŸ™',
  'ğŸ™ƒ',
  'ğŸ™…',
  'ğŸš€',
  'ğŸ›Œ',
  'ğŸ›',
  'ğŸ›‘',
  'ğŸ›«',
  'ğŸ›´',
  'ğŸ¤',
  'ğŸ¤™',
  'ğŸ¤ ',
  'ğŸ¤°',
  'ğŸ¤³',
  'ğŸ¤¼',
  'ğŸ¥€',
  'ğŸ¥‡',
  'ğŸ¥',
  'ğŸ¦€',
  'ğŸ¦…',
  'ğŸ§€',
  'â˜',
  'â›¹',
  'âœŠ',
  'âœŒ',
  'ğŸ…',
  'ğŸƒ',
  'ğŸŠ',
  'ğŸ‹',
  'ğŸ‘‚',
  'ğŸ‘†',
  'ğŸ‘¦',
  'ğŸ‘®',
  'ğŸ‘°',
  'ğŸ‘¼',
  'ğŸ’',
  'ğŸ’…',
  'ğŸ’ª',
  'ğŸ•µ',
  'ğŸ•º',
  'ğŸ–',
  'ğŸ–•',
  'ğŸ™…',
  'ğŸ™‹',
  'ğŸš£',
  'ğŸš´',
  'ğŸ›€',
  'ğŸ¤˜',
  'ğŸ¤™',
  'ğŸ¤¦',
  'ğŸ¤°',
  'ğŸ¤³',
  'ğŸ¤¼',
];

export class RandomojiHook implements Hook {
  private readonly client: Client;

  constructor(
    private readonly discordService: DiscordService,
    private readonly randomThrottleStrategyService: RandomThrottleStrategyService,
  ) {
    this.client = this.discordService.getClient();
  }

  async init() {


    const react = throttle({
      throttleStrategies: [
        this.randomThrottleStrategyService.getStrategy({
          chance: 1 / 74,
        })
      ],
      fire: (message: Message) => {
        const emojis = [
          ...list,
          ...message.guild!.emojis.cache.map((e: GuildEmoji) => e.identifier),
        ];

        const randomIndex = Math.floor(Math.random() * emojis.length);
        const emoji = emojis[randomIndex];

        if (emoji && message.author.bot === false) {
          message.react(emoji);
        }
      },
    });


    this.client.on('message', (message) => {
      react(message);
    });
  }

}

